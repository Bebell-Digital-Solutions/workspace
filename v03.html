<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Workspace Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #c4c4c4;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.1.0",
    "react-dom/": "https://esm.sh/react-dom@^19.1.0/",
    "react/": "https://esm.sh/react@^19.1.0/"
  }
}
</script>
</head>
<body class="bg-gray-100 antialiased">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        const { useState, useCallback, useRef, useEffect } = React;

        // --- TYPES ---
        // types.ts content would be here if needed, but for JS we can use prop-types or just be careful.

        // --- CONSTANTS ---
        const RESOURCES = [
            { name: 'Gemini', url: 'https://gemini.google.com' },
            { name: 'ChatGPT', url: 'https://chat.openai.com' },
            { name: 'DeepSeek', url: 'https://www.deepseek.com' },
            { name: 'Kimi', url: 'https://kimi.moonshot.cn' },
            { name: 'Wan2', url: 'https://www.wan2.cn' },
        ];

        const EDITOR_URLS = {
            docs: 'https://docs.google.com/document/create',
            sheets: 'https://docs.google.com/spreadsheets/create',
            slides: 'https://docs.google.com/presentation/create',
            html: '',
        };

        const TOOL_URLS = {
            checklist: 'https://bebell-digital-solutions.github.io/checklist-creator/',
            tasks: 'https://bebell-digital-solutions.github.io/tasks-manager/',
            links: 'https://bebell-digital-solutions.github.io/links-manager/es-v03',
        };

        const DEFAULT_HTML_CONTENT = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Document</title>
    <style>
        body { font-family: sans-serif; line-height: 1.6; padding: 20px; }
        h1 { color: #333; }
    </style>
</head>
<body>
    <h1>Welcome to the HTML Editor!</h1>
    <p>You can edit this content directly.</p>
</body>
</html>`;

        const EDITOR_OPTIONS = [
            { id: 'docs', name: 'Google Docs', icon: 'description' },
            { id: 'sheets', name: 'Google Sheets', icon: 'grid_on' },
            { id: 'slides', name: 'Google Slides', icon: 'slideshow' },
            { id: 'html', name: 'HTML Editor', icon: 'code' },
        ];

        const TOOL_BUTTONS = [
            { id: 'checklist', name: 'Checklist', icon: 'checklist' },
            { id: 'tasks', name: 'Tasks', icon: 'task_alt' },
            { id: 'links', name: 'Links', icon: 'link' },
        ];

        // --- COMPONENTS ---

        const Dropdown = ({ buttonContent, children, buttonClassName }) => {
            const [isOpen, setIsOpen] = useState(false);
            const dropdownRef = useRef(null);

            useEffect(() => {
                const handleClickOutside = (event) => {
                    if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {
                        setIsOpen(false);
                    }
                };
                document.addEventListener('mousedown', handleClickOutside);
                return () => {
                    document.removeEventListener('mousedown', handleClickOutside);
                };
            }, []);

            return (
                <div className="relative" ref={dropdownRef}>
                    <button onClick={() => setIsOpen(!isOpen)} className={buttonClassName}>
                        {buttonContent}
                    </button>
                    {isOpen && (
                        <div
                            className="absolute right-0 mt-2 w-56 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none py-1 z-50"
                            onClick={() => setIsOpen(false)}
                        >
                            {children}
                        </div>
                    )}
                </div>
            );
        };

        const ResizeHandle = ({ onMouseDown }) => {
            return (
                <div
                    className="w-2 h-full bg-gray-200 hover:bg-[#DF1783]/50 cursor-col-resize transition-colors duration-200 flex-shrink-0"
                    onMouseDown={onMouseDown}
                />
            );
        };

        const HtmlEditor = ({ content, setContent, onNewDocument }) => {
            const [viewMode, setViewMode] = useState('editor');

            const handleDownload = () => {
                const blob = new Blob([content], { type: 'text/html' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `document-${new Date().toISOString().slice(0, 10)}.html`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            return (
                <div className="flex flex-col h-full bg-gray-50">
                    <div className="flex items-center justify-between p-2 border-b bg-white shrink-0">
                        <div className="flex items-center space-x-2">
                            <button onClick={() => setViewMode('editor')} className={`px-3 py-1 rounded-md text-sm font-medium transition-colors ${viewMode === 'editor' ? 'bg-[#DF1783] text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>
                                Editor
                            </button>
                            <button onClick={() => setViewMode('preview')} className={`px-3 py-1 rounded-md text-sm font-medium transition-colors ${viewMode === 'preview' ? 'bg-[#DF1783] text-white' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`}>
                                Preview
                            </button>
                        </div>
                        <div className="flex items-center space-x-2">
                            <button onClick={onNewDocument} className="px-3 py-1 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm font-medium">
                                New Document
                            </button>
                            <button onClick={handleDownload} className="px-3 py-1 bg-[#DF1783] text-white rounded-md hover:bg-[#C11575] text-sm font-medium">
                                Download HTML
                            </button>
                        </div>
                    </div>
                    <div className="flex-1 overflow-auto">
                        {viewMode === 'editor' ? (
                             <textarea
                                value={content}
                                onChange={(e) => setContent(e.target.value)}
                                className="w-full h-full p-4 font-mono text-sm outline-none bg-white resize-none"
                            />
                        ) : (
                            <iframe srcDoc={content} title="HTML Preview" className="w-full h-full border-none bg-white" />
                        )}
                    </div>
                </div>
            );
        };

        const RightPanel = ({ activeView, htmlContent, setHtmlContent, onNewHtmlDocument }) => {
            const renderView = () => {
                if (activeView === 'html') {
                    return <HtmlEditor content={htmlContent} setContent={setHtmlContent} onNewDocument={onNewHtmlDocument} />;
                }

                const isEditor = Object.keys(EDITOR_URLS).includes(activeView);
                const isTool = Object.keys(TOOL_URLS).includes(activeView);
                let src = '';

                if (isEditor) src = EDITOR_URLS[activeView];
                else if (isTool) src = TOOL_URLS[activeView];

                return <iframe key={activeView} src={src} className="w-full h-full border-none bg-white" title={activeView}></iframe>;
            };

            return <div className="w-full h-full bg-white">{renderView()}</div>;
        };

        const LeftPanel = ({ browserUrl, setBrowserUrl }) => {
            const [inputValue, setInputValue] = useState(browserUrl);
            const iframeRef = useRef(null);

            const navigate = useCallback(() => {
                let url = inputValue.trim();
                if (url && !url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                setBrowserUrl(url);
                setInputValue(url);
            }, [inputValue, setBrowserUrl]);

            const handleResourceSelect = (resource) => {
                setBrowserUrl(resource.url);
                setInputValue(resource.url);
            };

            const handleIframeNav = () => {
                try {
                    if (iframeRef.current && iframeRef.current.contentWindow) {
                        const currentUrl = iframeRef.current.contentWindow.location.href;
                        if (currentUrl && !currentUrl.startsWith('about:blank')) {
                           setInputValue(currentUrl);
                        }
                    }
                } catch (error) {
                    console.warn("Could not access iframe URL due to cross-origin restrictions.");
                }
            };
            
            useEffect(() => {
                setInputValue(browserUrl);
            }, [browserUrl]);

            return (
                <div className="flex flex-col h-full bg-white shadow-md">
                    <div className="p-2 bg-gray-50 border-b border-gray-200 flex items-center space-x-1 shrink-0">
                         <Dropdown
                            buttonContent={ <div className="flex items-center"><span className="material-icons text-lg">bolt</span><span className="ml-1">Resources</span><span className="material-icons text-lg">arrow_drop_down</span></div> }
                            buttonClassName="px-2 py-1 bg-[#DF1783] text-white rounded-md text-sm font-medium hover:bg-[#C11575] transition-colors"
                        >
                            {RESOURCES.map((resource) => (
                                <div key={resource.name} onClick={() => handleResourceSelect(resource)} className="px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer">
                                    {resource.name}
                                </div>
                            ))}
                        </Dropdown>
                        <button onClick={() => iframeRef.current?.contentWindow?.history.back()} className="p-2 rounded-full hover:bg-gray-200 transition-colors text-gray-600" title="Back"><span className="material-icons">arrow_back</span></button>
                        <button onClick={() => iframeRef.current?.contentWindow?.history.forward()} className="p-2 rounded-full hover:bg-gray-200 transition-colors text-gray-600" title="Forward"><span className="material-icons">arrow_forward</span></button>
                        <button onClick={() => iframeRef.current?.contentWindow?.location.reload()} className="p-2 rounded-full hover:bg-gray-200 transition-colors text-gray-600" title="Refresh"><span className="material-icons">refresh</span></button>
                        <input
                            type="text"
                            value={inputValue}
                            onChange={(e) => setInputValue(e.target.value)}
                            onKeyDown={(e) => e.key === 'Enter' && navigate()}
                            className="flex-1 px-3 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-[#DF1783] focus:border-transparent text-sm"
                            placeholder="https://example.com"
                        />
                        <button onClick={navigate} className="px-4 py-1.5 bg-[#DF1783] text-white rounded-md hover:bg-[#C11575] transition-colors font-semibold text-sm">Go</button>
                    </div>
                    <div className="flex-1 bg-gray-200">
                        <iframe
                            ref={iframeRef}
                            src={browserUrl}
                            onLoad={handleIframeNav}
                            className="w-full h-full border-none"
                            title="Browser"
                            sandbox="allow-forms allow-modals allow-pointer-lock allow-popups allow-presentation allow-same-origin allow-scripts"
                        ></iframe>
                    </div>
                </div>
            );
        };
        
        const Header = ({ activeView, onViewChange }) => {
            return (
                <header className="bg-[#DF1783] shadow-lg py-2 px-6 flex items-center justify-between z-30">
                    <div className="flex items-center space-x-3">
                        <div className="text-white text-3xl">
                            <span className="material-icons" style={{ textShadow: '0 0 8px rgba(255,255,255,0.4)' }}>widgets</span>
                        </div>
                        <h1 className="text-xl font-bold text-white tracking-wide">Workspace Pro</h1>
                    </div>
                    <div className="flex items-center space-x-2">
                        {TOOL_BUTTONS.map(tool => (
                            <button key={tool.id} onClick={() => onViewChange(tool.id)} title={tool.name} className={`p-2 rounded-full transition-colors duration-200 ${activeView === tool.id ? 'bg-white text-[#DF1783]' : 'text-white hover:bg-white/20'}`}>
                                <span className="material-icons">{tool.icon}</span>
                            </button>
                        ))}
                        <div className="w-px h-6 bg-white/30 mx-2"></div>
                        <Dropdown
                            buttonContent={<div className="flex items-center space-x-2"><span>Select Editor</span><span className="material-icons">expand_more</span></div>}
                            buttonClassName="px-4 py-2 bg-white text-[#DF1783] rounded-md hover:bg-gray-100 font-semibold transition-all text-sm"
                        >
                            {EDITOR_OPTIONS.map((editor) => (
                                <div key={editor.id} onClick={() => onViewChange(editor.id)} className={`flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer ${activeView === editor.id ? 'bg-gray-200' : ''}`}>
                                    <span className="material-icons mr-3 text-gray-600">{editor.icon}</span>
                                    <span>{editor.name}</span>
                                </div>
                            ))}
                        </Dropdown>
                    </div>
                </header>
            );
        };

        const AuthModal = ({ onLogin }) => {
            return (
                <div className="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50 transition-opacity">
                    <div className="bg-white rounded-2xl shadow-2xl p-10 max-w-md w-full text-center transform transition-all scale-95 hover:scale-100 duration-300 ease-out">
                        <div className="mx-auto flex items-center justify-center h-20 w-20 rounded-full bg-gradient-to-tr from-pink-500 to-purple-500 -mt-20 shadow-lg">
                            <span className="material-icons text-white text-5xl">lock_open</span>
                        </div>
                        <h2 className="text-3xl font-bold text-gray-800 mt-6">Welcome to Workspace Pro</h2>
                        <p className="text-gray-600 mt-3 text-base">To access your workspace and sync your documents, please sign in with your Google Account.</p>
                        <div className="mt-8">
                            <button onClick={onLogin} className="w-full inline-flex justify-center items-center px-6 py-3 border border-gray-300 rounded-lg shadow-sm bg-white text-base font-medium text-gray-700 hover:bg-gray-50 transition-transform transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#DF1783]">
                                <svg className="w-6 h-6 mr-3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                                    <path fill="#FFC107" d="M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"></path>
                                    <path fill="#FF3D00" d="M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"></path>
                                    <path fill="#4CAF50" d="M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z"></path>
                                    <path fill="#1976D2" d="M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571l6.19,5.238C42.022,35.542,44,30.038,44,24C44,22.659,43.862,21.35,43.611,20.083z"></path>
                                </svg>
                                Sign in with Google
                            </button>
                        </div>
                        <p className="text-xs text-gray-500 mt-6">By signing in, you agree to our Terms of Service.</p>
                    </div>
                </div>
            );
        };

        const App = () => {
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [panelWidths, setPanelWidths] = useState({ left: 33.33, right: 66.67 });
            const [activeView, setActiveView] = useState('docs');
            const [htmlContent, setHtmlContent] = useState(DEFAULT_HTML_CONTENT);
            const [browserUrl, setBrowserUrl] = useState(RESOURCES[0].url);
            const [isResizing, setIsResizing] = useState(false);
            const mainContainerRef = useRef(null);

            const handleMouseDown = useCallback(() => setIsResizing(true), []);
            const handleMouseUp = useCallback(() => setIsResizing(false), []);

            const handleMouseMove = useCallback((e) => {
                if (!isResizing || !mainContainerRef.current) return;
                const containerRect = mainContainerRef.current.getBoundingClientRect();
                const newLeftWidth = ((e.clientX - containerRect.left) / containerRect.width) * 100;
                if (newLeftWidth > 15 && newLeftWidth < 85) {
                    setPanelWidths({ left: newLeftWidth, right: 100 - newLeftWidth });
                }
            }, [isResizing]);

            useEffect(() => {
                window.addEventListener('mousemove', handleMouseMove);
                window.addEventListener('mouseup', handleMouseUp);
                return () => {
                    window.removeEventListener('mousemove', handleMouseMove);
                    window.removeEventListener('mouseup', handleMouseUp);
                };
            }, [handleMouseMove, handleMouseUp]);

            const handleViewChange = useCallback((view) => setActiveView(view), []);

            const handleNewHtmlDocument = useCallback(() => {
                if (window.confirm('Are you sure you want to create a new document? Any unsaved changes will be lost.')) {
                    setHtmlContent(DEFAULT_HTML_CONTENT);
                }
            }, []);
            
            if (!isAuthenticated) {
                return <AuthModal onLogin={() => setIsAuthenticated(true)} />;
            }

            return (
                <div className="flex flex-col h-screen bg-gray-100 font-sans text-gray-800">
                    <Header onViewChange={handleViewChange} activeView={activeView} />
                    <main ref={mainContainerRef} className="flex flex-1 overflow-hidden" style={{ cursor: isResizing ? 'col-resize' : 'default' }}>
                        <div style={{ width: `${panelWidths.left}%` }} className="h-full flex flex-col">
                            <LeftPanel browserUrl={browserUrl} setBrowserUrl={setBrowserUrl} />
                        </div>
                        <ResizeHandle onMouseDown={handleMouseDown} />
                        <div style={{ width: `${panelWidths.right}%` }} className="h-full flex flex-col">
                            <RightPanel
                                activeView={activeView}
                                htmlContent={htmlContent}
                                setHtmlContent={setHtmlContent}
                                onNewHtmlDocument={handleNewHtmlDocument}
                            />
                        </div>
                    </main>
                </div>
            );
        };

        const rootElement = document.getElementById('root');
        const root = ReactDOM.createRoot(rootElement);
        root.render(<App />);

    </script>
</body>
</html>
